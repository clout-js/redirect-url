<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirect Page</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="mb-4">URL Redirector</h1>
      <div class="mb-3">
        <label for="urlInput" class="form-label">Application URL</label>
        <input
          type="text"
          class="form-control"
          id="urlInput"
          placeholder="https://example.com/app"
        />
      </div>
      <div class="mb-3">
        <label for="paramsInput" class="form-label">Query Parameters</label>
        <input
          type="text"
          class="form-control"
          id="paramsInput"
          placeholder="token=abc123&foo=bar"
        />
      </div>
      <button id="redirectCurrent" class="btn btn-primary me-2">
        Redirect (Current Tab)
      </button>
<!--       <button id="redirectNew" class="btn btn-secondary">
        Redirect (New Tab)
      </button> -->
    </div>

    <!-- Vanilla JS -->
    <script>
      function buildUrl(base, params) {
        if (!params) return base;
        return base + (params.trim().startsWith("?") ? params : "?" + params);
      }

      document
        .getElementById("redirectCurrent")
        .addEventListener("click", function () {
          const baseUrl = document.getElementById("urlInput").value.trim();
          const query = document.getElementById("paramsInput").value.trim();
          const key = query.slice(0,4)
          const value = encodeURIComponent(query.slice(4))
          const finalUrl = buildUrl(baseUrl, key+value);
          window.location.href = finalUrl;
        });

      document
        .getElementById("redirectNew")
        .addEventListener("click", function () {
          const baseUrl = document.getElementById("urlInput").value.trim();
          const query = document.getElementById("paramsInput").value.trim();
          const key = query.slice(0,4)
          const value = encodeURIComponent(query.slice(4))
          const finalUrl = buildUrl(baseUrl, key+value);
          window.open(finalUrl, "_blank");
        });
    </script>
  </body>
</html>
